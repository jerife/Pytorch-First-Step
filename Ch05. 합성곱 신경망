{"nbformat":4,"nbformat_minor":0,"metadata":{"colab":{"name":"Ch05. 합성곱 신경망","provenance":[],"collapsed_sections":[],"authorship_tag":"ABX9TyPqax1aJq0Zv+NlgdFQfCAd"},"kernelspec":{"name":"python3","display_name":"Python 3"},"language_info":{"name":"python"},"accelerator":"GPU","widgets":{"application/vnd.jupyter.widget-state+json":{"024f5497090749f8a195fcca5e55b758":{"model_module":"@jupyter-widgets/controls","model_name":"HBoxModel","state":{"_view_name":"HBoxView","_dom_classes":[],"_model_name":"HBoxModel","_view_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_view_count":null,"_view_module_version":"1.5.0","box_style":"","layout":"IPY_MODEL_58cbec59d7244c46b391c4ddc7e14d23","_model_module":"@jupyter-widgets/controls","children":["IPY_MODEL_7ad32db3ac1e43bc8e069d79910ddc74","IPY_MODEL_0b3afe51527346dcbc409391b2e13ecd"]}},"58cbec59d7244c46b391c4ddc7e14d23":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","state":{"_view_name":"LayoutView","grid_template_rows":null,"right":null,"justify_content":null,"_view_module":"@jupyter-widgets/base","overflow":null,"_model_module_version":"1.2.0","_view_count":null,"flex_flow":null,"width":null,"min_width":null,"border":null,"align_items":null,"bottom":null,"_model_module":"@jupyter-widgets/base","top":null,"grid_column":null,"overflow_y":null,"overflow_x":null,"grid_auto_flow":null,"grid_area":null,"grid_template_columns":null,"flex":null,"_model_name":"LayoutModel","justify_items":null,"grid_row":null,"max_height":null,"align_content":null,"visibility":null,"align_self":null,"height":null,"min_height":null,"padding":null,"grid_auto_rows":null,"grid_gap":null,"max_width":null,"order":null,"_view_module_version":"1.2.0","grid_template_areas":null,"object_position":null,"object_fit":null,"grid_auto_columns":null,"margin":null,"display":null,"left":null}},"7ad32db3ac1e43bc8e069d79910ddc74":{"model_module":"@jupyter-widgets/controls","model_name":"FloatProgressModel","state":{"_view_name":"ProgressView","style":"IPY_MODEL_d93436aa1b16480eba8aefc24cb59c77","_dom_classes":[],"description":"","_model_name":"FloatProgressModel","bar_style":"success","max":9912422,"_view_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","value":9912422,"_view_count":null,"_view_module_version":"1.5.0","orientation":"horizontal","min":0,"description_tooltip":null,"_model_module":"@jupyter-widgets/controls","layout":"IPY_MODEL_30c2c9669eb24e46a2083f0c7b5c8855"}},"0b3afe51527346dcbc409391b2e13ecd":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","state":{"_view_name":"HTMLView","style":"IPY_MODEL_f7efa9273b854e029a00a2c16f090c84","_dom_classes":[],"description":"","_model_name":"HTMLModel","placeholder":"​","_view_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","value":" 9913344/? [07:56&lt;00:00, 20802.44it/s]","_view_count":null,"_view_module_version":"1.5.0","description_tooltip":null,"_model_module":"@jupyter-widgets/controls","layout":"IPY_MODEL_99f3199e2843490d9fefb71885750ea8"}},"d93436aa1b16480eba8aefc24cb59c77":{"model_module":"@jupyter-widgets/controls","model_name":"ProgressStyleModel","state":{"_view_name":"StyleView","_model_name":"ProgressStyleModel","description_width":"initial","_view_module":"@jupyter-widgets/base","_model_module_version":"1.5.0","_view_count":null,"_view_module_version":"1.2.0","bar_color":null,"_model_module":"@jupyter-widgets/controls"}},"30c2c9669eb24e46a2083f0c7b5c8855":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","state":{"_view_name":"LayoutView","grid_template_rows":null,"right":null,"justify_content":null,"_view_module":"@jupyter-widgets/base","overflow":null,"_model_module_version":"1.2.0","_view_count":null,"flex_flow":null,"width":null,"min_width":null,"border":null,"align_items":null,"bottom":null,"_model_module":"@jupyter-widgets/base","top":null,"grid_column":null,"overflow_y":null,"overflow_x":null,"grid_auto_flow":null,"grid_area":null,"grid_template_columns":null,"flex":null,"_model_name":"LayoutModel","justify_items":null,"grid_row":null,"max_height":null,"align_content":null,"visibility":null,"align_self":null,"height":null,"min_height":null,"padding":null,"grid_auto_rows":null,"grid_gap":null,"max_width":null,"order":null,"_view_module_version":"1.2.0","grid_template_areas":null,"object_position":null,"object_fit":null,"grid_auto_columns":null,"margin":null,"display":null,"left":null}},"f7efa9273b854e029a00a2c16f090c84":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","state":{"_view_name":"StyleView","_model_name":"DescriptionStyleModel","description_width":"","_view_module":"@jupyter-widgets/base","_model_module_version":"1.5.0","_view_count":null,"_view_module_version":"1.2.0","_model_module":"@jupyter-widgets/controls"}},"99f3199e2843490d9fefb71885750ea8":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","state":{"_view_name":"LayoutView","grid_template_rows":null,"right":null,"justify_content":null,"_view_module":"@jupyter-widgets/base","overflow":null,"_model_module_version":"1.2.0","_view_count":null,"flex_flow":null,"width":null,"min_width":null,"border":null,"align_items":null,"bottom":null,"_model_module":"@jupyter-widgets/base","top":null,"grid_column":null,"overflow_y":null,"overflow_x":null,"grid_auto_flow":null,"grid_area":null,"grid_template_columns":null,"flex":null,"_model_name":"LayoutModel","justify_items":null,"grid_row":null,"max_height":null,"align_content":null,"visibility":null,"align_self":null,"height":null,"min_height":null,"padding":null,"grid_auto_rows":null,"grid_gap":null,"max_width":null,"order":null,"_view_module_version":"1.2.0","grid_template_areas":null,"object_position":null,"object_fit":null,"grid_auto_columns":null,"margin":null,"display":null,"left":null}},"e9d2b162c0574f148d369ea50bcaff7b":{"model_module":"@jupyter-widgets/controls","model_name":"HBoxModel","state":{"_view_name":"HBoxView","_dom_classes":[],"_model_name":"HBoxModel","_view_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_view_count":null,"_view_module_version":"1.5.0","box_style":"","layout":"IPY_MODEL_d84b26ca761a477a9fa1ba69040da760","_model_module":"@jupyter-widgets/controls","children":["IPY_MODEL_8f44e4d93baa48c99235f1036fb46369","IPY_MODEL_c7c96a1c601d4069ac4de7689bcfc26c"]}},"d84b26ca761a477a9fa1ba69040da760":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","state":{"_view_name":"LayoutView","grid_template_rows":null,"right":null,"justify_content":null,"_view_module":"@jupyter-widgets/base","overflow":null,"_model_module_version":"1.2.0","_view_count":null,"flex_flow":null,"width":null,"min_width":null,"border":null,"align_items":null,"bottom":null,"_model_module":"@jupyter-widgets/base","top":null,"grid_column":null,"overflow_y":null,"overflow_x":null,"grid_auto_flow":null,"grid_area":null,"grid_template_columns":null,"flex":null,"_model_name":"LayoutModel","justify_items":null,"grid_row":null,"max_height":null,"align_content":null,"visibility":null,"align_self":null,"height":null,"min_height":null,"padding":null,"grid_auto_rows":null,"grid_gap":null,"max_width":null,"order":null,"_view_module_version":"1.2.0","grid_template_areas":null,"object_position":null,"object_fit":null,"grid_auto_columns":null,"margin":null,"display":null,"left":null}},"8f44e4d93baa48c99235f1036fb46369":{"model_module":"@jupyter-widgets/controls","model_name":"FloatProgressModel","state":{"_view_name":"ProgressView","style":"IPY_MODEL_b3f54275f23542959bda6df11dec6e76","_dom_classes":[],"description":"","_model_name":"FloatProgressModel","bar_style":"success","max":28881,"_view_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","value":28881,"_view_count":null,"_view_module_version":"1.5.0","orientation":"horizontal","min":0,"description_tooltip":null,"_model_module":"@jupyter-widgets/controls","layout":"IPY_MODEL_2b054d92232b456da1ca8ebb47b42715"}},"c7c96a1c601d4069ac4de7689bcfc26c":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","state":{"_view_name":"HTMLView","style":"IPY_MODEL_e1fef6cdbd054584b78cfc0c04b02d8e","_dom_classes":[],"description":"","_model_name":"HTMLModel","placeholder":"​","_view_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","value":" 29696/? [00:00&lt;00:00, 65316.33it/s]","_view_count":null,"_view_module_version":"1.5.0","description_tooltip":null,"_model_module":"@jupyter-widgets/controls","layout":"IPY_MODEL_d91b1b3077f94476a50c04c616158487"}},"b3f54275f23542959bda6df11dec6e76":{"model_module":"@jupyter-widgets/controls","model_name":"ProgressStyleModel","state":{"_view_name":"StyleView","_model_name":"ProgressStyleModel","description_width":"initial","_view_module":"@jupyter-widgets/base","_model_module_version":"1.5.0","_view_count":null,"_view_module_version":"1.2.0","bar_color":null,"_model_module":"@jupyter-widgets/controls"}},"2b054d92232b456da1ca8ebb47b42715":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","state":{"_view_name":"LayoutView","grid_template_rows":null,"right":null,"justify_content":null,"_view_module":"@jupyter-widgets/base","overflow":null,"_model_module_version":"1.2.0","_view_count":null,"flex_flow":null,"width":null,"min_width":null,"border":null,"align_items":null,"bottom":null,"_model_module":"@jupyter-widgets/base","top":null,"grid_column":null,"overflow_y":null,"overflow_x":null,"grid_auto_flow":null,"grid_area":null,"grid_template_columns":null,"flex":null,"_model_name":"LayoutModel","justify_items":null,"grid_row":null,"max_height":null,"align_content":null,"visibility":null,"align_self":null,"height":null,"min_height":null,"padding":null,"grid_auto_rows":null,"grid_gap":null,"max_width":null,"order":null,"_view_module_version":"1.2.0","grid_template_areas":null,"object_position":null,"object_fit":null,"grid_auto_columns":null,"margin":null,"display":null,"left":null}},"e1fef6cdbd054584b78cfc0c04b02d8e":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","state":{"_view_name":"StyleView","_model_name":"DescriptionStyleModel","description_width":"","_view_module":"@jupyter-widgets/base","_model_module_version":"1.5.0","_view_count":null,"_view_module_version":"1.2.0","_model_module":"@jupyter-widgets/controls"}},"d91b1b3077f94476a50c04c616158487":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","state":{"_view_name":"LayoutView","grid_template_rows":null,"right":null,"justify_content":null,"_view_module":"@jupyter-widgets/base","overflow":null,"_model_module_version":"1.2.0","_view_count":null,"flex_flow":null,"width":null,"min_width":null,"border":null,"align_items":null,"bottom":null,"_model_module":"@jupyter-widgets/base","top":null,"grid_column":null,"overflow_y":null,"overflow_x":null,"grid_auto_flow":null,"grid_area":null,"grid_template_columns":null,"flex":null,"_model_name":"LayoutModel","justify_items":null,"grid_row":null,"max_height":null,"align_content":null,"visibility":null,"align_self":null,"height":null,"min_height":null,"padding":null,"grid_auto_rows":null,"grid_gap":null,"max_width":null,"order":null,"_view_module_version":"1.2.0","grid_template_areas":null,"object_position":null,"object_fit":null,"grid_auto_columns":null,"margin":null,"display":null,"left":null}},"dfda7b4ab7e74944bb190e5b63a31950":{"model_module":"@jupyter-widgets/controls","model_name":"HBoxModel","state":{"_view_name":"HBoxView","_dom_classes":[],"_model_name":"HBoxModel","_view_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_view_count":null,"_view_module_version":"1.5.0","box_style":"","layout":"IPY_MODEL_1f22c5b400b846cd901ee6c1e265443b","_model_module":"@jupyter-widgets/controls","children":["IPY_MODEL_a41c49824fd8453ba21547348e734c7e","IPY_MODEL_19ceadb4f92e4fb88688548a71bff6e3"]}},"1f22c5b400b846cd901ee6c1e265443b":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","state":{"_view_name":"LayoutView","grid_template_rows":null,"right":null,"justify_content":null,"_view_module":"@jupyter-widgets/base","overflow":null,"_model_module_version":"1.2.0","_view_count":null,"flex_flow":null,"width":null,"min_width":null,"border":null,"align_items":null,"bottom":null,"_model_module":"@jupyter-widgets/base","top":null,"grid_column":null,"overflow_y":null,"overflow_x":null,"grid_auto_flow":null,"grid_area":null,"grid_template_columns":null,"flex":null,"_model_name":"LayoutModel","justify_items":null,"grid_row":null,"max_height":null,"align_content":null,"visibility":null,"align_self":null,"height":null,"min_height":null,"padding":null,"grid_auto_rows":null,"grid_gap":null,"max_width":null,"order":null,"_view_module_version":"1.2.0","grid_template_areas":null,"object_position":null,"object_fit":null,"grid_auto_columns":null,"margin":null,"display":null,"left":null}},"a41c49824fd8453ba21547348e734c7e":{"model_module":"@jupyter-widgets/controls","model_name":"FloatProgressModel","state":{"_view_name":"ProgressView","style":"IPY_MODEL_e43de9684d994024ab177038c9a122b6","_dom_classes":[],"description":"","_model_name":"FloatProgressModel","bar_style":"success","max":1648877,"_view_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","value":1648877,"_view_count":null,"_view_module_version":"1.5.0","orientation":"horizontal","min":0,"description_tooltip":null,"_model_module":"@jupyter-widgets/controls","layout":"IPY_MODEL_9295f0fe5a1a4f618255af15ef704271"}},"19ceadb4f92e4fb88688548a71bff6e3":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","state":{"_view_name":"HTMLView","style":"IPY_MODEL_f71a0ec5e8d34afcb9f0ce5ba5a77dbc","_dom_classes":[],"description":"","_model_name":"HTMLModel","placeholder":"​","_view_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","value":" 1649664/? [04:50&lt;00:00, 5687.77it/s]","_view_count":null,"_view_module_version":"1.5.0","description_tooltip":null,"_model_module":"@jupyter-widgets/controls","layout":"IPY_MODEL_351098f6a4ff4a1eafa6dd53f638d888"}},"e43de9684d994024ab177038c9a122b6":{"model_module":"@jupyter-widgets/controls","model_name":"ProgressStyleModel","state":{"_view_name":"StyleView","_model_name":"ProgressStyleModel","description_width":"initial","_view_module":"@jupyter-widgets/base","_model_module_version":"1.5.0","_view_count":null,"_view_module_version":"1.2.0","bar_color":null,"_model_module":"@jupyter-widgets/controls"}},"9295f0fe5a1a4f618255af15ef704271":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","state":{"_view_name":"LayoutView","grid_template_rows":null,"right":null,"justify_content":null,"_view_module":"@jupyter-widgets/base","overflow":null,"_model_module_version":"1.2.0","_view_count":null,"flex_flow":null,"width":null,"min_width":null,"border":null,"align_items":null,"bottom":null,"_model_module":"@jupyter-widgets/base","top":null,"grid_column":null,"overflow_y":null,"overflow_x":null,"grid_auto_flow":null,"grid_area":null,"grid_template_columns":null,"flex":null,"_model_name":"LayoutModel","justify_items":null,"grid_row":null,"max_height":null,"align_content":null,"visibility":null,"align_self":null,"height":null,"min_height":null,"padding":null,"grid_auto_rows":null,"grid_gap":null,"max_width":null,"order":null,"_view_module_version":"1.2.0","grid_template_areas":null,"object_position":null,"object_fit":null,"grid_auto_columns":null,"margin":null,"display":null,"left":null}},"f71a0ec5e8d34afcb9f0ce5ba5a77dbc":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","state":{"_view_name":"StyleView","_model_name":"DescriptionStyleModel","description_width":"","_view_module":"@jupyter-widgets/base","_model_module_version":"1.5.0","_view_count":null,"_view_module_version":"1.2.0","_model_module":"@jupyter-widgets/controls"}},"351098f6a4ff4a1eafa6dd53f638d888":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","state":{"_view_name":"LayoutView","grid_template_rows":null,"right":null,"justify_content":null,"_view_module":"@jupyter-widgets/base","overflow":null,"_model_module_version":"1.2.0","_view_count":null,"flex_flow":null,"width":null,"min_width":null,"border":null,"align_items":null,"bottom":null,"_model_module":"@jupyter-widgets/base","top":null,"grid_column":null,"overflow_y":null,"overflow_x":null,"grid_auto_flow":null,"grid_area":null,"grid_template_columns":null,"flex":null,"_model_name":"LayoutModel","justify_items":null,"grid_row":null,"max_height":null,"align_content":null,"visibility":null,"align_self":null,"height":null,"min_height":null,"padding":null,"grid_auto_rows":null,"grid_gap":null,"max_width":null,"order":null,"_view_module_version":"1.2.0","grid_template_areas":null,"object_position":null,"object_fit":null,"grid_auto_columns":null,"margin":null,"display":null,"left":null}},"5b487e178c3547f69e68033307da6456":{"model_module":"@jupyter-widgets/controls","model_name":"HBoxModel","state":{"_view_name":"HBoxView","_dom_classes":[],"_model_name":"HBoxModel","_view_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_view_count":null,"_view_module_version":"1.5.0","box_style":"","layout":"IPY_MODEL_82674e51a0d342028100712019016558","_model_module":"@jupyter-widgets/controls","children":["IPY_MODEL_94641de88da44866aef85534c89a11c8","IPY_MODEL_fbcfb4f529224c2e9832ec11ceb8d995"]}},"82674e51a0d342028100712019016558":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","state":{"_view_name":"LayoutView","grid_template_rows":null,"right":null,"justify_content":null,"_view_module":"@jupyter-widgets/base","overflow":null,"_model_module_version":"1.2.0","_view_count":null,"flex_flow":null,"width":null,"min_width":null,"border":null,"align_items":null,"bottom":null,"_model_module":"@jupyter-widgets/base","top":null,"grid_column":null,"overflow_y":null,"overflow_x":null,"grid_auto_flow":null,"grid_area":null,"grid_template_columns":null,"flex":null,"_model_name":"LayoutModel","justify_items":null,"grid_row":null,"max_height":null,"align_content":null,"visibility":null,"align_self":null,"height":null,"min_height":null,"padding":null,"grid_auto_rows":null,"grid_gap":null,"max_width":null,"order":null,"_view_module_version":"1.2.0","grid_template_areas":null,"object_position":null,"object_fit":null,"grid_auto_columns":null,"margin":null,"display":null,"left":null}},"94641de88da44866aef85534c89a11c8":{"model_module":"@jupyter-widgets/controls","model_name":"FloatProgressModel","state":{"_view_name":"ProgressView","style":"IPY_MODEL_915f54b26bc148cba6535f7822e51c5a","_dom_classes":[],"description":"","_model_name":"FloatProgressModel","bar_style":"success","max":4542,"_view_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","value":4542,"_view_count":null,"_view_module_version":"1.5.0","orientation":"horizontal","min":0,"description_tooltip":null,"_model_module":"@jupyter-widgets/controls","layout":"IPY_MODEL_967f8c5c2051409cb0dce931acadff27"}},"fbcfb4f529224c2e9832ec11ceb8d995":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","state":{"_view_name":"HTMLView","style":"IPY_MODEL_1fb2e954024d4772a91fa39574b67e1b","_dom_classes":[],"description":"","_model_name":"HTMLModel","placeholder":"​","_view_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","value":" 5120/? [00:00&lt;00:00, 17682.58it/s]","_view_count":null,"_view_module_version":"1.5.0","description_tooltip":null,"_model_module":"@jupyter-widgets/controls","layout":"IPY_MODEL_084cf590eb6249ebab3e0c0c857fa604"}},"915f54b26bc148cba6535f7822e51c5a":{"model_module":"@jupyter-widgets/controls","model_name":"ProgressStyleModel","state":{"_view_name":"StyleView","_model_name":"ProgressStyleModel","description_width":"initial","_view_module":"@jupyter-widgets/base","_model_module_version":"1.5.0","_view_count":null,"_view_module_version":"1.2.0","bar_color":null,"_model_module":"@jupyter-widgets/controls"}},"967f8c5c2051409cb0dce931acadff27":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","state":{"_view_name":"LayoutView","grid_template_rows":null,"right":null,"justify_content":null,"_view_module":"@jupyter-widgets/base","overflow":null,"_model_module_version":"1.2.0","_view_count":null,"flex_flow":null,"width":null,"min_width":null,"border":null,"align_items":null,"bottom":null,"_model_module":"@jupyter-widgets/base","top":null,"grid_column":null,"overflow_y":null,"overflow_x":null,"grid_auto_flow":null,"grid_area":null,"grid_template_columns":null,"flex":null,"_model_name":"LayoutModel","justify_items":null,"grid_row":null,"max_height":null,"align_content":null,"visibility":null,"align_self":null,"height":null,"min_height":null,"padding":null,"grid_auto_rows":null,"grid_gap":null,"max_width":null,"order":null,"_view_module_version":"1.2.0","grid_template_areas":null,"object_position":null,"object_fit":null,"grid_auto_columns":null,"margin":null,"display":null,"left":null}},"1fb2e954024d4772a91fa39574b67e1b":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","state":{"_view_name":"StyleView","_model_name":"DescriptionStyleModel","description_width":"","_view_module":"@jupyter-widgets/base","_model_module_version":"1.5.0","_view_count":null,"_view_module_version":"1.2.0","_model_module":"@jupyter-widgets/controls"}},"084cf590eb6249ebab3e0c0c857fa604":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","state":{"_view_name":"LayoutView","grid_template_rows":null,"right":null,"justify_content":null,"_view_module":"@jupyter-widgets/base","overflow":null,"_model_module_version":"1.2.0","_view_count":null,"flex_flow":null,"width":null,"min_width":null,"border":null,"align_items":null,"bottom":null,"_model_module":"@jupyter-widgets/base","top":null,"grid_column":null,"overflow_y":null,"overflow_x":null,"grid_auto_flow":null,"grid_area":null,"grid_template_columns":null,"flex":null,"_model_name":"LayoutModel","justify_items":null,"grid_row":null,"max_height":null,"align_content":null,"visibility":null,"align_self":null,"height":null,"min_height":null,"padding":null,"grid_auto_rows":null,"grid_gap":null,"max_width":null,"order":null,"_view_module_version":"1.2.0","grid_template_areas":null,"object_position":null,"object_fit":null,"grid_auto_columns":null,"margin":null,"display":null,"left":null}}}}},"cells":[{"cell_type":"code","metadata":{"id":"x0U40I4E4xgv","executionInfo":{"status":"ok","timestamp":1619248018443,"user_tz":-540,"elapsed":1044,"user":{"displayName":"박재우","photoUrl":"https://lh3.googleusercontent.com/a-/AOh14GjXI3etzUNsHKseHtKKPAfY_N2c7kAIWyXOMk2v=s64","userId":"10125744057017928750"}}},"source":["import torch\n","import torch.nn as nn\n","import torch.optim as optim\n","import torch.nn.init as init\n","import torchvision.datasets as dset\n","import torchvision.transforms as transforms\n","from torch.utils.data import DataLoader\n","\n","import matplotlib.pyplot as plt"],"execution_count":26,"outputs":[]},{"cell_type":"code","metadata":{"id":"mwnh63MHgOzu","executionInfo":{"status":"ok","timestamp":1619246146050,"user_tz":-540,"elapsed":2749,"user":{"displayName":"박재우","photoUrl":"https://lh3.googleusercontent.com/a-/AOh14GjXI3etzUNsHKseHtKKPAfY_N2c7kAIWyXOMk2v=s64","userId":"10125744057017928750"}}},"source":["batch_size = 256\n","learning_rate = 0.001\n","num_epochs = 10"],"execution_count":2,"outputs":[]},{"cell_type":"code","metadata":{"colab":{"base_uri":"https://localhost:8080/","height":573,"referenced_widgets":["024f5497090749f8a195fcca5e55b758","58cbec59d7244c46b391c4ddc7e14d23","7ad32db3ac1e43bc8e069d79910ddc74","0b3afe51527346dcbc409391b2e13ecd","d93436aa1b16480eba8aefc24cb59c77","30c2c9669eb24e46a2083f0c7b5c8855","f7efa9273b854e029a00a2c16f090c84","99f3199e2843490d9fefb71885750ea8","e9d2b162c0574f148d369ea50bcaff7b","d84b26ca761a477a9fa1ba69040da760","8f44e4d93baa48c99235f1036fb46369","c7c96a1c601d4069ac4de7689bcfc26c","b3f54275f23542959bda6df11dec6e76","2b054d92232b456da1ca8ebb47b42715","e1fef6cdbd054584b78cfc0c04b02d8e","d91b1b3077f94476a50c04c616158487","dfda7b4ab7e74944bb190e5b63a31950","1f22c5b400b846cd901ee6c1e265443b","a41c49824fd8453ba21547348e734c7e","19ceadb4f92e4fb88688548a71bff6e3","e43de9684d994024ab177038c9a122b6","9295f0fe5a1a4f618255af15ef704271","f71a0ec5e8d34afcb9f0ce5ba5a77dbc","351098f6a4ff4a1eafa6dd53f638d888","5b487e178c3547f69e68033307da6456","82674e51a0d342028100712019016558","94641de88da44866aef85534c89a11c8","fbcfb4f529224c2e9832ec11ceb8d995","915f54b26bc148cba6535f7822e51c5a","967f8c5c2051409cb0dce931acadff27","1fb2e954024d4772a91fa39574b67e1b","084cf590eb6249ebab3e0c0c857fa604"]},"id":"02_4csuIfDVu","executionInfo":{"status":"ok","timestamp":1619246370199,"user_tz":-540,"elapsed":225678,"user":{"displayName":"박재우","photoUrl":"https://lh3.googleusercontent.com/a-/AOh14GjXI3etzUNsHKseHtKKPAfY_N2c7kAIWyXOMk2v=s64","userId":"10125744057017928750"}},"outputId":"d11df22b-3908-43b7-dff2-85c6fc7b1bcb"},"source":["mnist_train = dset.MNIST(\"./\", train=True, transform=transforms.ToTensor(), target_transform=None, download=True)\n","mnist_test = dset.MNIST(\"./\", train=False, transform=transforms.ToTensor(), target_transform=None, download=True)"],"execution_count":3,"outputs":[{"output_type":"stream","text":["Downloading http://yann.lecun.com/exdb/mnist/train-images-idx3-ubyte.gz\n","Downloading http://yann.lecun.com/exdb/mnist/train-images-idx3-ubyte.gz to ./MNIST/raw/train-images-idx3-ubyte.gz\n"],"name":"stdout"},{"output_type":"display_data","data":{"application/vnd.jupyter.widget-view+json":{"model_id":"024f5497090749f8a195fcca5e55b758","version_minor":0,"version_major":2},"text/plain":["HBox(children=(FloatProgress(value=0.0, max=9912422.0), HTML(value='')))"]},"metadata":{"tags":[]}},{"output_type":"stream","text":["\n","Extracting ./MNIST/raw/train-images-idx3-ubyte.gz to ./MNIST/raw\n","\n","Downloading http://yann.lecun.com/exdb/mnist/train-labels-idx1-ubyte.gz\n","Downloading http://yann.lecun.com/exdb/mnist/train-labels-idx1-ubyte.gz to ./MNIST/raw/train-labels-idx1-ubyte.gz\n"],"name":"stdout"},{"output_type":"display_data","data":{"application/vnd.jupyter.widget-view+json":{"model_id":"e9d2b162c0574f148d369ea50bcaff7b","version_minor":0,"version_major":2},"text/plain":["HBox(children=(FloatProgress(value=0.0, max=28881.0), HTML(value='')))"]},"metadata":{"tags":[]}},{"output_type":"stream","text":["\n","Extracting ./MNIST/raw/train-labels-idx1-ubyte.gz to ./MNIST/raw\n","\n","Downloading http://yann.lecun.com/exdb/mnist/t10k-images-idx3-ubyte.gz\n","Downloading http://yann.lecun.com/exdb/mnist/t10k-images-idx3-ubyte.gz to ./MNIST/raw/t10k-images-idx3-ubyte.gz\n"],"name":"stdout"},{"output_type":"display_data","data":{"application/vnd.jupyter.widget-view+json":{"model_id":"dfda7b4ab7e74944bb190e5b63a31950","version_minor":0,"version_major":2},"text/plain":["HBox(children=(FloatProgress(value=0.0, max=1648877.0), HTML(value='')))"]},"metadata":{"tags":[]}},{"output_type":"stream","text":["\n","Extracting ./MNIST/raw/t10k-images-idx3-ubyte.gz to ./MNIST/raw\n","\n","Downloading http://yann.lecun.com/exdb/mnist/t10k-labels-idx1-ubyte.gz\n","Downloading http://yann.lecun.com/exdb/mnist/t10k-labels-idx1-ubyte.gz to ./MNIST/raw/t10k-labels-idx1-ubyte.gz\n"],"name":"stdout"},{"output_type":"display_data","data":{"application/vnd.jupyter.widget-view+json":{"model_id":"5b487e178c3547f69e68033307da6456","version_minor":0,"version_major":2},"text/plain":["HBox(children=(FloatProgress(value=0.0, max=4542.0), HTML(value='')))"]},"metadata":{"tags":[]}},{"output_type":"stream","text":["\n","Extracting ./MNIST/raw/t10k-labels-idx1-ubyte.gz to ./MNIST/raw\n","\n","Processing...\n","Done!\n"],"name":"stdout"},{"output_type":"stream","text":["/usr/local/lib/python3.7/dist-packages/torchvision/datasets/mnist.py:502: UserWarning: The given NumPy array is not writeable, and PyTorch does not support non-writeable tensors. This means you can write to the underlying (supposedly non-writeable) NumPy array using the tensor. You may want to copy the array to protect its data or make it writeable before converting it to a tensor. This type of warning will be suppressed for the rest of this program. (Triggered internally at  /pytorch/torch/csrc/utils/tensor_numpy.cpp:143.)\n","  return torch.from_numpy(parsed.astype(m[2], copy=False)).view(*s)\n"],"name":"stderr"}]},{"cell_type":"code","metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"kZ5N55PohHh2","executionInfo":{"status":"ok","timestamp":1619246370200,"user_tz":-540,"elapsed":225207,"user":{"displayName":"박재우","photoUrl":"https://lh3.googleusercontent.com/a-/AOh14GjXI3etzUNsHKseHtKKPAfY_N2c7kAIWyXOMk2v=s64","userId":"10125744057017928750"}},"outputId":"6397365b-bd12-40bd-8049-aa9fae1ee5e8"},"source":["mnist_train"],"execution_count":4,"outputs":[{"output_type":"execute_result","data":{"text/plain":["Dataset MNIST\n","    Number of datapoints: 60000\n","    Root location: ./\n","    Split: Train\n","    StandardTransform\n","Transform: ToTensor()"]},"metadata":{"tags":[]},"execution_count":4}]},{"cell_type":"code","metadata":{"id":"GbfI5LYvf8Ze","executionInfo":{"status":"ok","timestamp":1619246370201,"user_tz":-540,"elapsed":224807,"user":{"displayName":"박재우","photoUrl":"https://lh3.googleusercontent.com/a-/AOh14GjXI3etzUNsHKseHtKKPAfY_N2c7kAIWyXOMk2v=s64","userId":"10125744057017928750"}}},"source":["train_loader = torch.utils.data.DataLoader(mnist_train, batch_size=batch_size, shuffle=True, num_workers=2, drop_last=True)\n","test_loader = torch.utils.data.DataLoader(mnist_test, batch_size=batch_size, shuffle=False, num_workers=2, drop_last=True)"],"execution_count":5,"outputs":[]},{"cell_type":"code","metadata":{"id":"wt7b0KevhQ0K","executionInfo":{"status":"ok","timestamp":1619246370763,"user_tz":-540,"elapsed":224852,"user":{"displayName":"박재우","photoUrl":"https://lh3.googleusercontent.com/a-/AOh14GjXI3etzUNsHKseHtKKPAfY_N2c7kAIWyXOMk2v=s64","userId":"10125744057017928750"}}},"source":["class CNN(nn.Module):\n","  def __init__(self):\n","    super(CNN, self).__init__()\n","    self.layer = nn.Sequential(\n","        nn.Conv2d(1,16,5), #int_channels, out_channels, kernel_size, stride, padding\n","        nn.ReLU(),\n","        nn.Conv2d(16,32,5),\n","        nn.ReLU(),\n","        nn.MaxPool2d(2,2),\n","        nn.Conv2d(32,64,5),\n","        nn.ReLU(),\n","        nn.MaxPool2d(2,2)\n","    )\n","    self.fc_layer = nn.Sequential(\n","        nn.Linear(64*3*3,100),\n","        nn.ReLU(),\n","        nn.Linear(100,10)\n","    )\n","\n","  def forward(self, x):\n","    out = self.layer(x)\n","    out = out.view(batch_size, -1)\n","    out = self.fc_layer(out)\n","    return out"],"execution_count":6,"outputs":[]},{"cell_type":"code","metadata":{"id":"V3oVHWO9ixii","executionInfo":{"status":"ok","timestamp":1619246379502,"user_tz":-540,"elapsed":233064,"user":{"displayName":"박재우","photoUrl":"https://lh3.googleusercontent.com/a-/AOh14GjXI3etzUNsHKseHtKKPAfY_N2c7kAIWyXOMk2v=s64","userId":"10125744057017928750"}}},"source":["device = torch.device(\"cuda:0\" if torch.cuda.is_available() else \"cpu\")\n","model = CNN().to(device)\n","loss_func = nn.CrossEntropyLoss()\n","optimizer = torch.optim.Adam(model.parameters(), lr=learning_rate)"],"execution_count":7,"outputs":[]},{"cell_type":"code","metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"W5qw-6TEkMYr","executionInfo":{"status":"ok","timestamp":1619246447227,"user_tz":-540,"elapsed":67715,"user":{"displayName":"박재우","photoUrl":"https://lh3.googleusercontent.com/a-/AOh14GjXI3etzUNsHKseHtKKPAfY_N2c7kAIWyXOMk2v=s64","userId":"10125744057017928750"}},"outputId":"69b1b15c-cd6c-4e40-d6ab-7ccdbabfab03"},"source":["loss_arr = []\n","for i in range(num_epochs):\n","  for j,[image, label] in enumerate(train_loader):\n","    x = image.to(device)\n","    y = label.to(device)\n","\n","    optimizer.zero_grad()\n","    output = model.forward(x)\n","    loss = loss_func(output, y)\n","    loss.backward()\n","    optimizer.step()\n","\n","    if j%1000 == 0:\n","      print(loss)\n","      loss_arr.append(loss.cpu().detach().numpy())"],"execution_count":8,"outputs":[{"output_type":"stream","text":["tensor(2.3040, device='cuda:0', grad_fn=<NllLossBackward>)\n","tensor(0.1069, device='cuda:0', grad_fn=<NllLossBackward>)\n","tensor(0.0323, device='cuda:0', grad_fn=<NllLossBackward>)\n","tensor(0.0298, device='cuda:0', grad_fn=<NllLossBackward>)\n","tensor(0.0103, device='cuda:0', grad_fn=<NllLossBackward>)\n","tensor(0.0198, device='cuda:0', grad_fn=<NllLossBackward>)\n","tensor(0.0068, device='cuda:0', grad_fn=<NllLossBackward>)\n","tensor(0.0497, device='cuda:0', grad_fn=<NllLossBackward>)\n","tensor(0.0112, device='cuda:0', grad_fn=<NllLossBackward>)\n","tensor(0.0092, device='cuda:0', grad_fn=<NllLossBackward>)\n"],"name":"stdout"}]},{"cell_type":"code","metadata":{"colab":{"base_uri":"https://localhost:8080/","height":281},"id":"lF9ujspZtjTC","executionInfo":{"status":"ok","timestamp":1619248198238,"user_tz":-540,"elapsed":823,"user":{"displayName":"박재우","photoUrl":"https://lh3.googleusercontent.com/a-/AOh14GjXI3etzUNsHKseHtKKPAfY_N2c7kAIWyXOMk2v=s64","userId":"10125744057017928750"}},"outputId":"8716fe4f-6aa7-4b11-d1bd-63515db85ec8"},"source":["plt.plot(loss_arr)\n","plt.title(\"Basic CNN Loss Plot\")\n","plt.show()"],"execution_count":28,"outputs":[{"output_type":"display_data","data":{"image/png":"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\n","text/plain":["<Figure size 432x288 with 1 Axes>"]},"metadata":{"tags":[],"needs_background":"light"}}]},{"cell_type":"code","metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"fuUjCeBKlZlv","executionInfo":{"status":"ok","timestamp":1619246861278,"user_tz":-540,"elapsed":2211,"user":{"displayName":"박재우","photoUrl":"https://lh3.googleusercontent.com/a-/AOh14GjXI3etzUNsHKseHtKKPAfY_N2c7kAIWyXOMk2v=s64","userId":"10125744057017928750"}},"outputId":"9de11855-6bb1-40c0-b496-1518fa87def5"},"source":["correct = 0\n","total = 0\n","\n","with torch.no_grad():#기울기를 계산하지 않겠다\n","  for image, label in test_loader:\n","    x = image.to(device)\n","    y = label.to(device)\n","\n","    output = model.forward(x)\n","    _, output_index = torch.max(output,1)#최대값과 그 인덱스 값을 구한다.\n","\n","    total += label.size(0)\n","    correct += (output_index == y).sum().float()\n","\n","print(\"Accuracy of Test Data ; {}\".format(100*correct/total))\n"],"execution_count":11,"outputs":[{"output_type":"stream","text":["Accuracy of Test Data ; 99.08854675292969\n"],"name":"stdout"}]},{"cell_type":"code","metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"ajdqMWzHoNOm","executionInfo":{"status":"ok","timestamp":1619246929339,"user_tz":-540,"elapsed":1157,"user":{"displayName":"박재우","photoUrl":"https://lh3.googleusercontent.com/a-/AOh14GjXI3etzUNsHKseHtKKPAfY_N2c7kAIWyXOMk2v=s64","userId":"10125744057017928750"}},"outputId":"77342e36-aca6-43ee-c7bb-a875c53138e1"},"source":["(output_index == y).sum().float()"],"execution_count":13,"outputs":[{"output_type":"execute_result","data":{"text/plain":["tensor(253., device='cuda:0')"]},"metadata":{"tags":[]},"execution_count":13}]},{"cell_type":"markdown","metadata":{"id":"YcVmPNFGpFJt"},"source":["### VGGNet\n","- This Model based on \"3*3Conv2d / MaxPooling / FC\""]},{"cell_type":"code","metadata":{"id":"Ex3xNe1PoxsA","executionInfo":{"status":"ok","timestamp":1619247282505,"user_tz":-540,"elapsed":988,"user":{"displayName":"박재우","photoUrl":"https://lh3.googleusercontent.com/a-/AOh14GjXI3etzUNsHKseHtKKPAfY_N2c7kAIWyXOMk2v=s64","userId":"10125744057017928750"}}},"source":["def conv_2_block(in_dim, out_dim):\n","  model = nn.Sequential(\n","      nn.Conv2d(in_dim, out_dim, kernel_size=3, padding=1),\n","      nn.ReLU(),\n","      nn.Conv2d(in_dim, out_dim, kernel_size=3, padding=1),\n","      nn.ReLU(),\n","      nn.MaxPool2d(2,2)\n","  )\n","  return model"],"execution_count":14,"outputs":[]},{"cell_type":"code","metadata":{"id":"3uiFJqhyqLU_","executionInfo":{"status":"ok","timestamp":1619247343709,"user_tz":-540,"elapsed":980,"user":{"displayName":"박재우","photoUrl":"https://lh3.googleusercontent.com/a-/AOh14GjXI3etzUNsHKseHtKKPAfY_N2c7kAIWyXOMk2v=s64","userId":"10125744057017928750"}}},"source":["def conv_3_block(ind_dim, out_dim):\n","  model = nn.Sequential(\n","      nn.Conv2d(in_dim, out_dim, kernel_size=3, padding=1),\n","      nn.ReLU(),\n","      nn.Conv2d(in_dim, out_dim, kernel_size=3, padding=1),\n","      nn.ReLU(),\n","      nn.Conv2d(in_dim, out_dim, kernel_size=3, padding=1),\n","      nn.ReLU(),\n","      nn.MaxPool2d(2,2)\n","  )\n","  return model"],"execution_count":15,"outputs":[]},{"cell_type":"code","metadata":{"id":"-1iaH-vGqaRX","executionInfo":{"status":"ok","timestamp":1619247768991,"user_tz":-540,"elapsed":945,"user":{"displayName":"박재우","photoUrl":"https://lh3.googleusercontent.com/a-/AOh14GjXI3etzUNsHKseHtKKPAfY_N2c7kAIWyXOMk2v=s64","userId":"10125744057017928750"}}},"source":["class VGG(nn.Module):\n","  def __init__(self, base_dim, num_classes=2):\n","    super(VGG, self).__init__()\n","    self.layer = nn.Sequential(\n","        conv_2_block(3,base_dim),\n","        conv_2_block(base_dim,2*base_dim),\n","        conv_3_block(2*base_dim,4*base_dim),\n","        conv_3_block(4*base_dim,8*base_dim),\n","        conv_3_block(8*base_dim,8*base_dim),\n","    )\n","    self.fc_layer = nn.Sequential(\n","        nn.Linear(8*base_dim*7*7, 100),\n","        nn.ReLu(True),\n","        nn.Linear(100,20),\n","        nn.ReLU(True),\n","        nn.Linear(20, num_classes)\n","    )\n","\n","  def forward(self, x):\n","    x = self.layer(x)\n","    x = x.view(x.size(0), -1)\n","    x = self.fc_layer(x)\n","    return x"],"execution_count":19,"outputs":[]},{"cell_type":"markdown","metadata":{"id":"GOkLzEf-t4of"},"source":["### GoogLeNet\n","* This Model based on \"Inception Module\""]},{"cell_type":"code","metadata":{"id":"d6LzDdY7stph","executionInfo":{"status":"ok","timestamp":1619249653384,"user_tz":-540,"elapsed":883,"user":{"displayName":"박재우","photoUrl":"https://lh3.googleusercontent.com/a-/AOh14GjXI3etzUNsHKseHtKKPAfY_N2c7kAIWyXOMk2v=s64","userId":"10125744057017928750"}}},"source":["def Inception_conv_1(in_dim, out_dim):\n","  model = nn.Seqeuntial(\n","      nn.Conv2d(in_dim, out_dim,1,1),\n","      nn.ReLU()\n","  )\n","  return model"],"execution_count":42,"outputs":[]},{"cell_type":"code","metadata":{"id":"LASKcG9BvaYY","executionInfo":{"status":"ok","timestamp":1619249653385,"user_tz":-540,"elapsed":714,"user":{"displayName":"박재우","photoUrl":"https://lh3.googleusercontent.com/a-/AOh14GjXI3etzUNsHKseHtKKPAfY_N2c7kAIWyXOMk2v=s64","userId":"10125744057017928750"}}},"source":["def Inception_conv_1_3(in_dim, mid_dim, out_dim):\n","  model = nn.Seqeuntial(\n","      nn.Conv2d(in_dim, mid_dim,1,1),\n","      nn.ReLU(),\n","      nn.Conv2d(mid_dim, out_dim,3,1,1),\n","      nn.ReLU()\n","  )\n","  return model"],"execution_count":43,"outputs":[]},{"cell_type":"code","metadata":{"id":"cQtLBL6MwBaP","executionInfo":{"status":"ok","timestamp":1619249653386,"user_tz":-540,"elapsed":520,"user":{"displayName":"박재우","photoUrl":"https://lh3.googleusercontent.com/a-/AOh14GjXI3etzUNsHKseHtKKPAfY_N2c7kAIWyXOMk2v=s64","userId":"10125744057017928750"}}},"source":["def Inception_conv_1_5(in_dim, mid_dim, out_dim):\n","  model = nn.Seqeuntial(\n","      nn.Conv2d(in_dim, mid_dim,1,1),\n","      nn.ReLU(),\n","      nn.Conv2d(mid_dim, out_dim,5,1,2),\n","      nn.ReLU()\n","  )\n","  return model"],"execution_count":44,"outputs":[]},{"cell_type":"code","metadata":{"id":"N-q_bFG-wajM","executionInfo":{"status":"ok","timestamp":1619249654430,"user_tz":-540,"elapsed":1324,"user":{"displayName":"박재우","photoUrl":"https://lh3.googleusercontent.com/a-/AOh14GjXI3etzUNsHKseHtKKPAfY_N2c7kAIWyXOMk2v=s64","userId":"10125744057017928750"}}},"source":["def Inception_max_3_1(in_dim, out_dim):\n","  model = nn.Seqeuntial(\n","      nn.MaxPool2d(3,1,1),\n","      nn.Conv2d(in_dim, out_dim,1,1),\n","      nn.ReLU()\n","  )\n","  return model"],"execution_count":45,"outputs":[]},{"cell_type":"code","metadata":{"id":"HHSPuVGpxi7q","executionInfo":{"status":"ok","timestamp":1619249905714,"user_tz":-540,"elapsed":959,"user":{"displayName":"박재우","photoUrl":"https://lh3.googleusercontent.com/a-/AOh14GjXI3etzUNsHKseHtKKPAfY_N2c7kAIWyXOMk2v=s64","userId":"10125744057017928750"}}},"source":["class inception_moudule(nn.Module):\n","  def __init__(self, in_dim, out_dim_1, mid_dim_3, out_dim_3, mid_dim_5, out_dim_5, pool):\n","    super(inception_moudule, self).__init__()\n","\n","    self.conv_1 = Inception_conv_1(in_dim, out_dim_1)\n","    self.conv_1_3 = Inception_conv_1_3(in_dim, mid_dim_3, out_dim_3)\n","    self.conv_1_5 = Inception_conv_1_5(in_dim, mid_dim_5, out_dim_5)\n","    self.max_3_1 = Inception_max_3_1(in_dim, pool)\n","\n","  def forward(self, x):\n","    out_1 = self.conv_1(X)\n","    out_2 = self.conv_1_3(x)\n","    out_3 = self.conv_1_5(x)\n","    out_4 = self.max_3_1(x)\n","    output = torch.cat([out_1, out_2, out_3, out_4])\n","    return output"],"execution_count":46,"outputs":[]},{"cell_type":"code","metadata":{"id":"IWzwG99byzZQ","executionInfo":{"status":"ok","timestamp":1619250852760,"user_tz":-540,"elapsed":893,"user":{"displayName":"박재우","photoUrl":"https://lh3.googleusercontent.com/a-/AOh14GjXI3etzUNsHKseHtKKPAfY_N2c7kAIWyXOMk2v=s64","userId":"10125744057017928750"}}},"source":["class GoogLeNet(nn.Module):\n","  def __init__(self, base_dim, num_classes=2):\n","    super(GoogLeNet, self).__init__()\n","    self.layer_1 = nn.Sequential(\n","        nn.Conv2d(3, base_dim,7,2,3),\n","        nn.MaxPool2d(3,2,1),\n","        nn.Conv2d(base_dim, base_dim*3,3,1,1),\n","        nn.MaxPool2d(3,2,1)\n","    )\n","    self.layer_2 = nn.Sequential(\n","        inception_moudule(base_dim*3,64,96,128,16,32,32),\n","        inception_moudule(base_dim*4,128,128,192,32,96,64),\n","        nn.MaxPool2d(3,2,1)\n","    )\n","    self.layer_3 = nn.Sequential(\n","        inception_moudule(480,192,96,208,16,48,64),\n","        inception_moudule(512,160,112,224,24,64,64),\n","        inception_moudule(512,128,128,256,24,64,64),\n","        inception_moudule(512,112,144,288,32,64,64),\n","        inception_moudule(528,256,160,320,32,128,128),\n","        nn.MaxPool2d(3,2,1)\n","    )\n","    self.layer_4 = nn.Sequential(\n","        inception_moudule(832,256,160,320,32,128,128),\n","        inception_moudule(832,384,192,384,48,128,128),\n","        nn.AvgPool2d(7,1)\n","    )\n","    self.layer_5 = nn.Dropout2d(0.4)\n","    self.fc_layer = nn.Linear(1024,1000)\n","\n","  def forward(self, x):\n","    out = self.layer_1(x)\n","    out = self.layer_2(x)\n","    out = self.layer_3(x)\n","    out = self.layer_4(x)\n","    out = self.layer_5(x)\n","    out = out.view(batcj_size, -1)\n","    out = self.fc_layer(out)\n","\n","    return out"],"execution_count":49,"outputs":[]},{"cell_type":"markdown","metadata":{"id":"1swwzYio4mQC"},"source":["### ResNet\n","* This Model based on \"Bottle Neck(Short Cut)\""]},{"cell_type":"code","metadata":{"id":"ROPWqkIg1qsU","executionInfo":{"status":"ok","timestamp":1619252765384,"user_tz":-540,"elapsed":921,"user":{"displayName":"박재우","photoUrl":"https://lh3.googleusercontent.com/a-/AOh14GjXI3etzUNsHKseHtKKPAfY_N2c7kAIWyXOMk2v=s64","userId":"10125744057017928750"}}},"source":["def Resnet_conv_block_1(ind_dim, out_dim, act_fn, stride=1):\n","  model = nn.Sequential(\n","      nn.Conv2d(in_dim, out_dim, kernel_size=1, stride=stride),\n","      act_fn\n","  )\n","  return model"],"execution_count":50,"outputs":[]},{"cell_type":"code","metadata":{"id":"_d37BO6z_Fw8","executionInfo":{"status":"ok","timestamp":1619252800929,"user_tz":-540,"elapsed":816,"user":{"displayName":"박재우","photoUrl":"https://lh3.googleusercontent.com/a-/AOh14GjXI3etzUNsHKseHtKKPAfY_N2c7kAIWyXOMk2v=s64","userId":"10125744057017928750"}}},"source":["def Resnet_conv_block_3(ind_dim, out_dim, act_fn):\n","  model = nn.Sequential(\n","      nn.Conv2d(in_dim, out_dim, kernel_size=3, stride=stride, padding=1),\n","      act_fn\n","  )\n","  return model"],"execution_count":51,"outputs":[]},{"cell_type":"code","metadata":{"id":"9rK2IVfl_Oo4","executionInfo":{"status":"ok","timestamp":1619253309285,"user_tz":-540,"elapsed":902,"user":{"displayName":"박재우","photoUrl":"https://lh3.googleusercontent.com/a-/AOh14GjXI3etzUNsHKseHtKKPAfY_N2c7kAIWyXOMk2v=s64","userId":"10125744057017928750"}}},"source":["class BottleNeck(nn.Module):\n","  def __init__(self, in_dim, mid_dim, out_dim, act_fn, down=False):#down = 블록을 통과했을 때 특성 지도의 크기가 줄어드는 지 여부를 닮은 불리언 변수\n","    super(BottleNeck, self).__init__()\n","    self.act_fn = act_fn\n","    self.down = down\n","\n","    if self.down:\n","      self.layer = nn.Sequential(\n","          Resnet_conv_block_1(in_dim, mid_dim, act_fn, 2),\n","          Resnet_conv_block_3(mid_dim, mid_dim, act_fn),\n","          Resnet_conv_block_1(mid_dim, out_dim, act_fn)\n","      )\n","      self.downsample = nn.Conv2d(in_dim, out_dim,1,2)\n","    else:\n","      self.layer = nn.Sequential(\n","          Resnet_conv_block_1(in_dim, mid_dim, act_fn, 2),\n","          Resnet_conv_block_3(mid_dim, mid_dim, act_fn),\n","          Resnet_conv_block_1(mid_dim, out_dim, act_fn)\n","      )\n","      self.dim_equalizer = nn. Conv2d(in_dim, out_dim, kernel_size=1)\n","\n","    def forward(self, x):\n","      if self.down:\n","        downsample = self.downsample(x)\n","        out = self.layer(x)\n","        out = out + downsample\n","      else:\n","        out = self.layer(x)\n","        if x.size() is not out.size():\n","          x = self.dim_equalizer(x)\n","      out = out + x\n","    return out"],"execution_count":55,"outputs":[]},{"cell_type":"code","metadata":{"id":"fGA-755vABQ0"},"source":[""],"execution_count":null,"outputs":[]}]}